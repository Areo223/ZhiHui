<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.areo.zhihui.mapper.EnrollmentMapper">
    <select id="checkIfStudentHasSelectedCourse" resultType="java.lang.Boolean">
        select exists(
            select 1
            from enrollment e
            where e.student_id = #{studentId} and e.teaching_class_id = #{courseId}
        )
    </select>
    <select id="isStudentHasSelectedCourse" resultType="java.lang.Boolean">
        select exists(select 1
                      from enrollment e
                      where e.student_id = (select s.id
                                            from student s
                                                     inner join user u
                                                                on s.user_id = u.id
                                            where u.identifier = #{studentIdentifier})
                        and e.teaching_class_id = (select t.id
                                                   from teaching_class t
                                                   where t.teaching_class_code = #{teachingClassCode}))
    </select>
</mapper>